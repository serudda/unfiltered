---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './Layout.astro';
import Header from '@/components/site/Header.astro';
import { formatRelativeTime } from '@/utils/dates';
import { SITE_LINKS } from '@/constants/links';

interface Props {
  frontmatter: CollectionEntry<'posts'>['data'];
  canonical: string;
  lang?: 'en' | 'es';
  alternateLinks?: Array<{ href: string; lang: string }>;
}

const { frontmatter, canonical, lang = 'en', alternateLinks = [] } = Astro.props;

// Format date
const dateObj = new Date(frontmatter.date);
const day = dateObj.getDate();
const year = dateObj.getFullYear();
const month = dateObj.toLocaleDateString('en-US', { month: 'long' });
const capitalizedMonth = month.charAt(0).toUpperCase() + month.slice(1);

const formattedDate = `${capitalizedMonth} ${day}, ${year}`;
const relativeTime = formatRelativeTime(frontmatter.date);

---

<BaseLayout
  title={frontmatter.title}
  description={frontmatter.description}
  canonical={canonical}
  lang={lang}
  alternateLinks={alternateLinks}
>
  <Header lang={lang} />
  
  <main class="py-20">
    <article>
      <!-- Post Header -->
      <header>
        <h1 class="mb-2 text-5xl font-bold">{frontmatter.title}</h1>
        
        <div class="flex flex-wrap items-center gap-2 ml-1 text-sm text-muted-foreground">
          <a 
            href={SITE_LINKS.twitter.url} 
            target="_blank" 
            rel="noopener noreferrer" 
            class="font-medium hover:text-primary-400 transition-colors"
          >
            {SITE_LINKS.twitter.handle}
          </a>
          <span aria-hidden="true">Â·</span>
          <time class="font-serif" datetime={frontmatter.date.toISOString()}>
            {formattedDate} ({relativeTime})
          </time>
        </div>
      </header>

      <hr class="border-dashed-x my-6 mb-10" />
      
      <!-- Post Content -->
      <div class="font-serif text-xl text-foreground">
        <slot />
      </div>
    </article>
  </main>
</BaseLayout>
